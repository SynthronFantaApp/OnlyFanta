<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>OnlyFanta – Assistente Asta Fantacalcio</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <!-- HERO SECTION -->
  <header class="hero">
    <img src="logo.png" alt="OnlyFanta Logo" class="logo" />
    <h1>OnlyFanta</h1>
    <h2>Il tuo assistente intelligente per l’asta del fantacalcio</h2>
    <a href="#prova" class="cta">Prova Gratis</a>
  </header>

  <!-- COME FUNZIONA -->
  <section class="how-it-works">
    <h3>Come funziona</h3>
    <div class="steps">
      <div>
        <span>1️⃣</span>
        <p>Carica o scegli il tuo listone</p>
      </div>
      <div>
        <span>2️⃣</span>
        <p>Analizza i dati avanzati dei giocatori</p>
      </div>
      <div>
        <span>3️⃣</span>
        <p>Fai l’asta simulata o assistita in tempo reale</p>
      </div>
    </div>
  </section>

  <!-- FEATURES -->
  <section class="features">
    <h3>Funzionalità Chiave</h3>
    <ul>
      <li>📊 Statistiche dettagliate per ogni giocatore</li>
      <li>🔄 Confronto annate (2023/24, 2024/25)</li>
      <li>🤖 Suggerimenti in tempo reale durante l’asta</li>
      <li>💰 Gestione crediti e monitoraggio squadre avversarie</li>
      <li>🔥 Heatmap e dati avanzati</li>
      <li>🎯 Suggerimenti sui migliori acquisti in base alla strategia scelta</li>
    </ul>
  </section>

  <!-- NUOVA SEZIONE: Carica Listone -->
  <section class="tabella-giocatori">
    <h3>Carica il tuo Listone (PDF)</h3>
    <input type="file" id="input-listone-pdf" accept="application/pdf" />
    <button id="rimuovi-listone" style="display:none; margin-left:12px;">Rimuovi Listone</button>
    <div id="preview-listone" style="margin-top:16px;"></div>
  </section>

  <!-- DEMO / PREVIEW -->
  <section class="demo">
    <h3>Demo Interattiva</h3>
    <img src="demo.jpg" alt="Demo app" style="max-width:400px;">
    <p>(Qui puoi mettere uno screen, una GIF, o un video demo)</p>
  </section>

  <!-- CTA / REGISTRAZIONE -->
  <section class="cta-area" id="prova">
    <h3>Vuoi provare OnlyFanta?</h3>
    <a href="https://forms.gle/tuoform" class="cta">Registrati Gratis</a>
    <p>(Sostituisci il link con il tuo Google Form o quello che vuoi tu)</p>
  </section>

  <!-- FAQ -->
  <section class="faq">
    <h3>FAQ</h3>
    <details>
      <summary>Funziona con tutti i listoni?</summary>
      <p>Sì, puoi caricare qualsiasi listone PDF/CSV/Excel/Google Sheet.</p>
    </details>
    <details>
      <summary>Serve inserire dati a mano?</summary>
      <p>No, puoi importare direttamente le statistiche da N8N o usare quelle già pronte.</p>
    </details>
    <details>
      <summary>Posso usarlo anche per il Mantra?</summary>
      <p>Certo! L’app è ottimizzata sia per Classic che per Mantra.</p>
    </details>
  </section>

  <!-- FOOTER -->
  <footer>
    <p>© 2025 OnlyFanta – <a href="mailto:info@onlyfanta.it">Contatti</a> – <a href="#">Privacy Policy</a></p>
  </footer>

  <!-- PDF.js e LOGICA PREVIEW LISTONE -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
  <script>
  function salvaListone(data) {
    localStorage.setItem('listonePDFbase64', data);
  }
  function prendiListone() {
    return localStorage.getItem('listonePDFbase64');
  }
  function rimuoviListone() {
    localStorage.removeItem('listonePDFbase64');
  }

  document.getElementById('input-listone-pdf').addEventListener('change', function(e) {
    const file = e.target.files[0];
    if (file && file.type === "application/pdf") {
      const reader = new FileReader();
      reader.onload = function(ev) {
        const base64 = ev.target.result.split(',')[1];
        salvaListone(base64);
        mostraAnteprimaListone(base64);
      }
      reader.readAsDataURL(file);
    }
  });

  document.getElementById('rimuovi-listone').addEventListener('click', function() {
    rimuoviListone();
    location.reload();
  });

  function mostraAnteprimaListone(base64) {
    document.getElementById('rimuovi-listone').style.display = "inline-block";
    // PDF.js rendering preview prime 10 righe (PRIMA PAGINA)
    const pdfData = atob(base64);
    const loadingTask = pdfjsLib.getDocument({data: pdfData});
    loadingTask.promise.then(pdf => {
      pdf.getPage(1).then(page => {
        page.getTextContent().then(function(textContent) {
          const txt = textContent.items.map(x => x.str).join('\n');
          let lines = txt.split('\n').filter(l => l.trim()).slice(0,10);
          let html = "<pre style='background:#eee;padding:9px;border-radius:7px;font-size:1em;max-width:100%;overflow-x:auto;'>" + lines.join('\n') + "</pre>";
          html += "<button id='visualizza-tutto' style='margin-top:10px;'>Visualizza tutto il Listone</button>";
          document.getElementById('preview-listone').innerHTML = html;
          document.getElementById('visualizza-tutto').onclick = function() {
            window.location.href = "listone.html";
          }
        });
      });
    });
  }

  // Se già caricato → mostra anteprima all’avvio
  const listoneSalvato = prendiListone();
  if (listoneSalvato) {
    mostraAnteprimaListone(listoneSalvato);
    document.getElementById('input-listone-pdf').style.display = "none";
  }
  </script>
</body>
</html>
