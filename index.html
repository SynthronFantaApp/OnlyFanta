<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>OnlyFanta â€“ Assistente Asta Fantacalcio</title>
  <link rel="stylesheet" href="style.css">
  <!-- jsPDF + pdf.js for PDF parsing -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.min.js"></script>
</head>
<body>
  <!-- HERO SECTION -->
  <header class="hero">
    <img src="logo.png" alt="OnlyFanta Logo" class="logo" />
    <h1>OnlyFanta</h1>
    <h2>Il tuo assistente intelligente per lâ€™asta del fantacalcio</h2>
    <a href="#prova" class="cta">Prova Gratis</a>
  </header>

  <!-- COME FUNZIONA -->
  <section class="how-it-works">
    <h3>Come funziona</h3>
    <div class="steps">
      <div>
        <span>1ï¸âƒ£</span>
        <p>
          Carica o scegli il tuo listone<br>
          <input type="file" id="carica-listone" accept="application/pdf" style="margin-top:8px;">
        </p>
      </div>
      <div>
        <span>2ï¸âƒ£</span>
        <p>Analizza i dati avanzati dei giocatori</p>
      </div>
      <div>
        <span>3ï¸âƒ£</span>
        <p>Fai lâ€™asta simulata o assistita in tempo reale</p>
      </div>
    </div>
    <!-- Anteprima tabella sotto STEP 1 -->
    <div id="preview-listone" style="margin-top:16px;"></div>
  </section>

  <!-- FEATURES -->
  <section class="features">
    <h3>FunzionalitÃ  Chiave</h3>
    <ul>
      <li>ğŸ“Š Statistiche dettagliate per ogni giocatore</li>
      <li>ğŸ”„ Confronto annate (2023/24)</li>
      <li>ğŸ¤– Suggerimenti in tempo reale durante lâ€™asta</li>
      <li>ğŸ’° Gestione crediti e monitoraggio squadre avversarie</li>
      <li>ğŸ”¥ Heatmap e dati avanzati</li>
      <li>ğŸ¯ Suggerimenti sui migliori acquisti in base alla strategia scelta</li>
    </ul>
  </section>

  <!-- ...il resto della landing resta UGUALE... -->

  <section class="demo">
    <h3>Demo Interattiva</h3>
    <img src="demo.jpg" alt="Demo app" style="max-width:400px;">
    <p>(Qui puoi mettere uno screen, una GIF, o un video demo)</p>
  </section>
  <section class="cta-area" id="prova">
    <h3>Vuoi provare OnlyFanta?</h3>
    <a href="https://forms.gle/tuoform" class="cta">Registrati Gratis</a>
    <p>(Sostituisci il link con il tuo Google Form o quello che vuoi tu)</p>
  </section>
  <section class="faq">
    <h3>FAQ</h3>
    <details>
      <summary>Funziona con tutti i listoni?</summary>
      <p>SÃ¬, puoi caricare qualsiasi listone PDF/CSV/Excel/Google Sheet.</p>
    </details>
    <details>
      <summary>Serve inserire dati a mano?</summary>
      <p>No, puoi importare direttamente le statistiche da N8N o usare quelle giÃ  pronte.</p>
    </details>
    <details>
      <summary>Posso usarlo anche per il Mantra?</summary>
      <p>Certo! Lâ€™app Ã¨ ottimizzata sia per Classic che per Mantra.</p>
    </details>
  </section>
  <footer>
    <p>Â© 2025 OnlyFanta â€“ <a href="mailto:info@onlyfanta.it">Contatti</a> â€“ <a href="#">Privacy Policy</a></p>
  </footer>

<script>
let fileData = null, lastTableHTML = "";

// Carica PDF â†’ Preview tabella
document.getElementById('carica-listone').addEventListener('change', async function(e) {
  const file = e.target.files[0];
  if (!file) return;
  const arrayBuffer = await file.arrayBuffer();
  const pdf = await pdfjsLib.getDocument({data: arrayBuffer}).promise;

  let testo = "";
  for (let i = 1; i <= pdf.numPages; i++) {
    const page = await pdf.getPage(i);
    const content = await page.getTextContent();
    testo += content.items.map(item => item.str).join(" ") + "\n";
  }
  fileData = testo;
  showPreviewTable(testo);
});

function showPreviewTable(txt) {
  // Estrae righe tabellari, cerca pattern colonne (adatta se serve)
  const rows = txt.split('\n').map(r => r.trim()).filter(r => r && r.length > 15);
  // Heuristic: prendi solo righe con numeri (esclude titoli) e almeno 3 colonne
  const tabRows = rows.filter(r => /\d{1,3}\s+[A-Za-z]{2,}\s+\d/.test(r));
  let anteprima = tabRows.slice(0, 10);
  let html = "<table border='1' cellpadding='7'><thead><tr><th>Riga</th></tr></thead><tbody>";
  anteprima.forEach(r => html += `<tr><td>${r}</td></tr>`);
  html += "</tbody></table>";
  if(tabRows.length > 10) html += `<button id="vedi-tutto" style="margin-top:10px;">Visualizza tutto</button>`;
  lastTableHTML = tabRows.map(r => `<tr><td>${r}</td></tr>`).join("");
  document.getElementById('preview-listone').innerHTML = html;

  // Visualizza tutto
  const btn = document.getElementById("vedi-tutto");
  if(btn) btn.onclick = function(){
    document.getElementById('preview-listone').innerHTML =
      "<table border='1' cellpadding='7'><thead><tr><th>Riga</th></tr></thead><tbody>"
      + lastTableHTML +
      "</tbody></table>";
  };
}

// Al refresh mostra ancora lâ€™ultima preview caricata (usando localStorage)
window.onload = () => {
  if (fileData) showPreviewTable(fileData);
};

</script>
</body>
</html>
